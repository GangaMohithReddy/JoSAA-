<html lang="en">
  <head>
    <link
      href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <title>Institution Analysis Dashboard</title>
  </head>
  <body>
    <div>
      <canvas id="myChartCanvas"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      var myChartData = {
        labels: [2020, 2021, 2022],
        datasets: [
          {% for item in data2 %}
          {
            label: '{{item.institution}} - {{item.Branch}}',
            data: [
              {% for record in data1 %}
              {% if record.institution == item.institution %}
              {{record.Closing_rank}},
              {% endif %}
              {% endfor %}
            ],
            fill: false,
            backgroundColor: [
              'rgba(231, 76, 60, 0.8)',
              'rgba(120, 128, 185, 0.8)',
              'rgba(241, 196, 15, 0.8)',
              'rgba(89, 174, 96, 0.8)',
              'rgba(142, 68, 173, 0.8)',
              'rgba(69, 156, 18, 0.8)',
              'rgba(192, 57, 43, 0.8)',
            ],
            borderColor: [
              'rgba(231, 76, 60, 1)',
              'rgba(120, 128, 185, 1)',
              'rgba(241, 196, 15, 1)',
              'rgba(89, 174, 96, 1)',
              'rgba(142, 68, 173, 1)',
              'rgba(69, 156, 18, 1)',
              'rgba(192, 57, 43, 1)',
            ],
            borderWidth: 2,
          },
          {% endfor %}
        ],
      };

      const ctx = document.getElementById('myChartCanvas');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: myChartData.labels,
          datasets: myChartData.datasets,
        },
        options: {
          animations: {
            tension: {
              duration: 1200,
              easing: 'easeInOutQuad',
              from: 0.4,
              to: 0.1,
              loop: true,
            },
          },
          plugins: {
            title: {
              display: true,
              text: 'Institutional Trends Analysis',
              color: '#ecf081',
            },
            legend: {
              position: 'bottom',
              align: 'start',
              labels: {
                color: '#ecf081',
                boxWidth: 18,
                font: {
                  size: 13,
                  family: "'Kalam', cursive",
                },
              },
            },
          },
          elements: {
            point: {
              hitRadius: 6,
              hoverRadius: 10,
              pointStyle: 'triangle',
            },
          },
          scales: {
            x: {
              grid: {
                display: true,
                color: "#2f8c8d",
                lineWidth: 1.5,
              },
              ticks: {
                color: "#3cf0f1",
                maxRotation: 50,
                minRotation: 50,
              },
            },
            y: {
              grid: {
                display: true,
                color: "#2f8c8d",
              },
              ticks: {
                color: "#3cf0f1",
              },
            },
          },
        },
      });
    </script>
  </body>
</html>
